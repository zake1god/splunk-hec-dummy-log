import json
import random
from datetime import datetime, timedelta

malware_names = ["Trojan.GenericKD", "Worm.AutoRun", "Backdoor.Win32", "Ransom.Crypto", "Exploit.CVE-2024-1234"]detection_sources = ["EDR Agent", "Antivirus", "Threat Intel Feed", "YARA Scan"]
hosts = [f"host-{i}.corp.local" for i in range(1, 20)]

def generate_malware_log():
    return {
        "timestamp": (datetime.now() - timedelta(minutes=random.randint(0, 300))).isoformat(),
        "host": random.choice(hosts),
        "malware_name": random.choice(malware_names),
        "severity": random.choice(["low", "medium", "high", "critical"]),
        "source": random.choice(detection_sources),
        "file_path": f"C:\\Users\\User{random.randint(1, 50)}\\AppData\\Roaming\\malicious.exe",
        "action_taken": random.choice(["quarantined", "deleted", "none"])
    }

logs = [{"event": generate_malware_log()} for _ in range(100)]

with open("malware_logs.json", "w") as f:
    for log in logs:
        json.dump(log, f)
        f.write("\n")

print("Berhasil generate 100 malware logs di 'malware_logs.json'")
